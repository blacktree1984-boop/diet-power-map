name: Update Political Data

on:
  schedule:
    # æ¯é€±æœˆæ›œæ—¥ã®åˆå‰9æ™‚(JST)ã«å®Ÿè¡Œï¼ˆUTCã§0æ™‚ï¼‰
    - cron: '0 0 * * 1'
  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½
  workflow_dispatch:

permissions:
  contents: write

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install requests networkx pandas lxml html5lib beautifulsoup4
          
      - name: Run analysis script
        run: |
          python analyze.py
        env:
          PYTHONIOENCODING: utf-8
          
      - name: Verify data.json was created
        run: |
          if [ ! -f data.json ]; then
            echo "Error: data.json was not created"
            exit 1
          fi
          echo "data.json created successfully"
          # JSONãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼
          python -c "import json; json.load(open('data.json'))"
          echo "data.json is valid JSON"
          
      - name: Display statistics
        run: |
          if [ -f data.json ]; then
            echo "File size: $(wc -c < data.json) bytes"
            python -c "
import json
with open('data.json', 'r', encoding='utf-8') as f:
    data = json.load(f)
    print(f\"Nodes: {len(data.get('nodes', []))}\")
    print(f\"Links: {len(data.get('links', []))}\")
    print(f\"Categories: {len(data.get('categories', []))}\")
"
          fi
          
      - name: Commit and push changes
        run: |
          git config --global user.name "GitHub Actions Bot"
          git config --global user.email "actions@github.com"
          
          # data.jsonã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°
          git add data.json
          
          # å¤‰æ›´ãŒã‚ã‚Œã°ã‚³ãƒŸãƒƒãƒˆ
          if git diff --staged --quiet; then
            echo "No changes to commit"
          else
            git commit -m "ğŸ¤– Update political data - $(date '+%Y-%m-%d %H:%M:%S')"
            git push
            echo "Changes committed and pushed successfully"
          fi
          
      - name: Upload artifact
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: political-data
          path: data.json
          retention-days: 30
```

4. **ã€ŒCommit new fileã€**ã‚’ã‚¯ãƒªãƒƒã‚¯

5. **æ•°ç§’å¾…ã£ã¦**ã‹ã‚‰ã€**ã€ŒActionsã€**ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯

ã“ã‚Œã§å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ã€ŒUpdate Political Dataã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ï¼

---

### åŸå› 2: GitHub ActionsãŒç„¡åŠ¹ã«ãªã£ã¦ã„ã‚‹

**ç¢ºèªæ–¹æ³•**ï¼š
1. **ã€ŒSettingsã€**ã‚¿ãƒ– â†’ **ã€ŒActionsã€** â†’ **ã€ŒGeneralã€**
2. ã€ŒActions permissionsã€ã‚’ç¢ºèª

**è§£æ±ºæ–¹æ³•**ï¼š
- **ã€ŒAllow all actions and reusable workflowsã€**ã‚’é¸æŠ
- **ã€ŒSaveã€**ã‚’ã‚¯ãƒªãƒƒã‚¯
- **ã€ŒActionsã€**ã‚¿ãƒ–ã«æˆ»ã£ã¦ç¢ºèª

---

### åŸå› 3: YAMLãƒ•ã‚¡ã‚¤ãƒ«ã«æ–‡æ³•ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚‹

**ç¢ºèªæ–¹æ³•**ï¼š
1. ãƒªãƒã‚¸ãƒˆãƒªã§ `.github/workflows/update.yml` ã‚’é–‹ã
2. ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç¢ºèª

**ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼**ï¼š
- ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆã‚¹ãƒšãƒ¼ã‚¹ï¼‰ãŒã‚ºãƒ¬ã¦ã„ã‚‹
- ã‚³ãƒ”ãƒšæ™‚ã«ä½™åˆ†ãªæ–‡å­—ãŒå…¥ã£ãŸ
- ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ãŒ `.yml` ã§ã¯ãªã `.txt` ã‚„ `.yaml` ã«ãªã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**ï¼š
- ä¸Šè¨˜ã®æ­£ã—ã„å†…å®¹ã‚’å†åº¦ã‚³ãƒ”ãƒ¼&ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ä¸Šæ›¸ã

---

## âœ… æ­£ã—ãé…ç½®ã§ããŸã‹ç¢ºèªã™ã‚‹æ–¹æ³•

ãƒªãƒã‚¸ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OKï¼š
```
ğŸ“ .github
  ğŸ“ workflows
    ğŸ“„ update.yml
ğŸ“„ analyze.py
ğŸ“„ index.html
ğŸ“„ README.md
ğŸ“„ requirements.txt
...ï¼ˆãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
